{"version":3,"sources":["services/pubSub/pubSub.js","utils/obj-utils.js","utils/color-utils.js","utils/cutout-style.utils.js","utils/path-utils.js","Components/Polygon.js","Components/ScanFeedback.js","Components/ScanFeedbackManager.js","utils/animations.js","Components/Cutout.js","services/timeout.js","services/mask/mask-service.js","utils/benchmark.js","utils/test-utils.js","Components/Mask.js","Components/CutoutManager.js","App.js","serviceWorker.js","index.js"],"names":["pubSub","createPubSub","sinks","publish","event","data","next","console","warn","concat","getSinks","subscribe","cb","Object","assign","defineProperty","Subject","window","byKey","arr","key","reduce","acc","el","objectSpread","hexToRGBa","hex","alpha","arguments","length","undefined","r","parseInt","slice","g","b","HexARGB2rgba","str","replace","includes","Error","substring","a","getStrokeWidth","_ref","strokeWidth","getStrokeColor","_ref2","strokeColor","getFillColor","_ref3","fillColor","generateSroke","props","createRoundedPathString","pathCoords","curveRadius","path","filter","i","c2Index","c3Index","c1","c2","c3","c1c2Distance","Math","sqrt","pow","x","y","c1c2DistanceRatio","c1c2CurvePoint","toFixed","c2c3DistanceRatio","c2c3CurvePoint","unshift","join","push","Svg","styled","svg","withConfig","displayName","componentId","svgOffset","top","left","compose","withProps","points","rest","objectWithoutProperties","cornerRadius","_ref4","getCornerRadius","pathComponent","react_default","createElement","d","map","slicedToArray","toConsumableArray","_ref5","_ref6","newElements","Rect","div","initialStyle","width","height","borderRadius","show","Wrapper","feedbackStyle","ScanFeedbackElement","forwardRef","innerRef","esm_extends","ref","polygonOffset","bbox","x1","y1","x2","y2","calculateBoundingBox","Components_Polygon","quickPopupTransition","transition","_ref$duration","duration","elements","type","values","times","opacity","blinkFadeInTransition","pulseFadeInTransition","resizeHeightTransition","_ref5$duration","scaleY","resizeBorderTransition","_ref6$duration","scale","animations","TRAVERSE_MULTI","parent","active","staggerChildren","_ref7","children","_ref7$duration","reverse","inactive","child","_ref2$duration","TRAVERSE_SINGLE","KITT","staggerDirection","BLINK","RESIZE","underline","_ref8","_ref8$duration","point","_ref9","_ref9$duration","PULSE","delayChildren","_ref10","firstRun","ResizePointChild","posed","ResizePointParent","ResizeUnderlineChild","ResizeUnderlineParent","TraverseMultiChild","TraverseMultiParent","TraverseSingleChild","TraverseSingleParent","PulseChild","PulseParent","BlinkChild","BlinkParent","KittChild","components","none","_ref11","kitt","blink","pulse","traverse_multi","traverse_single","resize_point","resize_underline","resize","getRectStyle","feedbackElements","_feedbackElements$","defaultProps","config","animation","toLowerCase","renderRect","withState","withHandlers","handlePoseComplete","setPose","setFirstRun","setFeedbackElements","pose","lifecycle","componentDidMount","_this$props","this","componentWillReceiveProps","nextProps","lastFeedbackUpdate","hiddenElements","e","hidden","initialRectStyle","cutoutId","hide","_getAnimationElements","_ref12","_ref12$feedbackStyle","_ref12$animation","getAnimationElements","_getAnimationElements2","AnimationParent","AnimatedScanFeedbackElement","ScanFeedbackManager_Wrapper","style","display","onPoseComplete","animationDuration","visibility","timeout","ctx","ms","clearTimeout","setTimeout","createTimeoutService","rect","right","bottom","scanning","feedbackStrokeColor","getAnimationTimeout","fade","zoom","Components_Cutout","scanFeedback","renderFeedback","resetScanTimeout","setScanning","setShow","CSSTransition_default","classNames","Cutout_Wrapper","ScanFeedbackManager","id","limitCordnerRadius","w","h","halfMin","min","sleep","Promise","createFeedbacks","initial","feedbacks","getFeedbacks","set","newFeedbacks","add","feedback","_callee","_ref$setupCutoutsConf","setupCutoutsConfig","_ref$feedbackCount","feedbackCount","random","initialfeedbacks1","initialfeedbacks2","initialfeedbacks3","feedbackService","updatedFeedbacks","_args","regenerator_default","wrap","_context","prev","outerColor","outerAlpha","redrawTimeout","visible","max","floor","Array","apply","time","1","timeEnd","stop","runFeedbackBenchmark","maskService","setupCutoutsObservable","removeCutoutsObservable","updateFeedbackObservable","setupMaskObservable","getMissingIds","nextCutouts","cutouts","keys","Canvas","canvas","setCanvasRef","refs","withRefs","onInit","initializeMaskService","offsetWidth","offsetHeight","canvasEl","_ref$outerColor","_ref$outerAlpha","_ref$rerenderOnAdd","rerenderOnAdd","_ref$rerenderOnRemove","rerenderOnRemove","currentCutoutState","outerRGBa","getContext","drawRect","_ref2$cornerRadius","_ref2$strokeWidth","beginPath","moveTo","lineTo","arc","PI","closePath","fillStyle","fill","fillWhole","fillRect","render","clearRect","globalCompositeOperation","forEach","update","requestAnimationFrame","addCutout","cutout","modifyCutout","removeCutout","setConfig","newOuterColor","newOuterAlpha","createMaskService","updateCanvasDimensions","addEventListener","componentWillUnmount","removeEventListener","_this","lastUpdate","propTypes","PropTypes","object","isRequired","isVisible","absoluteToRelative","useSvgOffset","enhance","externalHoc","handleAnimatonEnterStart","handleAnimatonEnterEnd","handleAnimatonExitEnd","handleMaskInit","service","setupCutouts","setCutouts","newCutouts","enhancedCutouts","c","Date","now","cutoutsObj","old","updateFeedback","newFeedbackData","updatedCutouts","entries","removeCutouts","_ref13","cutoutIds","obj","stringKeys","k","toString","value","omit","_ref14","visibleCutouts","pubsub","throttle","setMaskConfig","unsubscribe","setPropTypes","maskConfig","CutoutManager_Wrapper","Components_Mask","TransitionGroup_default","onEntered","onEnter","onExited","App","App_Wrapper","Components_CutoutManager","Boolean","location","hostname","match","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.cfca9854.chunk.js","sourcesContent":["import { Subject } from 'rxjs';\n\nlet pubSub;\n\nexport function createPubSub() {\n  // singleton\n  if (pubSub) return pubSub;\n\n  const sinks = {};\n\n  const getSinks = () => sinks;\n\n  const publish = (event, data) => {\n    if (!sinks[event]) {\n      console.warn(\n        `${event} does not have any registered listeners. Publish cancelled.`,\n      );\n      return false;\n    }\n\n    return sinks[event].next(data);\n  };\n\n  const subscribe = (event, cb) => {\n    if (!cb) {\n      console.warn(\n        'No callback provided for subscription. Subscription cancelled.',\n      );\n      return false;\n    }\n\n    if (!sinks[event]) {\n      Object.assign(sinks, { [event]: new Subject() });\n    }\n\n    return sinks[event].subscribe(cb);\n  };\n\n  pubSub = {\n    getSinks,\n    publish,\n    subscribe,\n  };\n\n  window.publish = publish;\n\n  return pubSub;\n}\n\nexport default createPubSub();\n","/**\n * Converts an array of objects into an object by defining a shared key of all objects.\n * @param  {Object[]} arr the array of objects\n * @param  {string} key the shared key of all objects, which value will be used as the key\n * @returns {Object}\n */\nexport const byKey = (arr, key) => (\n  arr.reduce((acc, el) => ({ ...acc, [el[key]]: el }), {})\n);\n\n/**\n * Omits keys of an object\n * @param  {Object} obj\n * @param  {string[]} keys the keys to be ommited\n * @returns {Object} the reduced object\n */\nexport const omit = (obj, keys) => {\n  const stringKeys = keys.map(k => k.toString()); // convert keys to strings\n  return Object.entries(obj).reduce(\n    (acc, [key, value]) =>\n      stringKeys.includes(key) ? acc : { ...acc, [key]: value },\n    {},\n  );\n};\n\nexport const isEqual = (a, b) => JSON.stringify(a) === JSON.stringify(b);\n","export function hexToRGBa(hex, alpha = 0) {\n  const r = parseInt(hex.slice(0, 2), 16);\n  const g = parseInt(hex.slice(2, 4), 16);\n  const b = parseInt(hex.slice(4, 6), 16);\n\n  return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n}\n\nexport function HexARGB2rgba(str = '') {\n  str = str.replace('#', '');\n  if (![6, 8].includes(str.length))\n    throw Error('invalid hey HexARGB string use length of 6 or 8');\n  if (str.length === 6) {\n    const r = parseInt(str.substring(0, 2), 16);\n    const g = parseInt(str.substring(2, 4), 16);\n    const b = parseInt(str.substring(4, 6), 16);\n    return `rgb(${r}, ${g}, ${b})`;\n  }\n\n  if (str.length === 8) {\n    const a = parseInt(str.substring(0, 2), 16) / 255;\n    const r = parseInt(str.substring(2, 4), 16);\n    const g = parseInt(str.substring(4, 6), 16);\n    const b = parseInt(str.substring(6, 8), 16);\n    return `rgba(${r}, ${g}, ${b}, ${a})`;\n  }\n}\n","import { HexARGB2rgba } from './color-utils';\n\nconst STROKE_COLOR = 'AA0099FF';\nconst STROKE_WIDTH = 2;\nconst CORNER_RADIUS = 0;\nconst FILL_COLOR = '00000000';\n\nexport const getStrokeWidth = ({ strokeWidth }) => strokeWidth || STROKE_WIDTH;\n\nexport const getStrokeColor = ({ strokeColor }) =>\n  HexARGB2rgba(strokeColor || STROKE_COLOR);\n\nexport const getFillColor = ({ fillColor }) =>\n  HexARGB2rgba(fillColor || FILL_COLOR);\n\nexport const getCornerRadius = ({ cornerRadius }) =>\n  `${cornerRadius || CORNER_RADIUS}px`;\n\nexport const generateSroke = props =>\n  `${getStrokeWidth(props)}px solid ${getStrokeColor(props)}`;\n","export default function createRoundedPathString(pathCoords, curveRadius = 2) {\n  const path = [];\n\n  // Reset indexes, so there are no gaps\n  pathCoords = pathCoords.filter(() => true);\n\n  for (let i = 0; i < pathCoords.length; i += 1) {\n    // 1. Get current coord and the next two\n    // (startpoint, cornerpoint, endpoint) to calculate rounded curve\n    const c2Index =\n      i + 1 > pathCoords.length - 1 ? (i + 1) % pathCoords.length : i + 1;\n    const c3Index =\n      i + 2 > pathCoords.length - 1 ? (i + 2) % pathCoords.length : i + 2;\n\n    const c1 = pathCoords[i];\n\n    const c2 = pathCoords[c2Index];\n\n    const c3 = pathCoords[c3Index];\n\n    // 2. For each 3 coords, enter two new path commands:\n    // Line to start of curve, bezier curve around corner.\n\n    // Calculate curvePoint c1 -> c2\n    const c1c2Distance = Math.sqrt(\n      // eslint-disable-next-line no-restricted-properties\n      Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2),\n    );\n    const c1c2DistanceRatio = (c1c2Distance - curveRadius) / c1c2Distance;\n    const c1c2CurvePoint = [\n      ((1 - c1c2DistanceRatio) * c1.x + c1c2DistanceRatio * c2.x).toFixed(1),\n      ((1 - c1c2DistanceRatio) * c1.y + c1c2DistanceRatio * c2.y).toFixed(1),\n    ];\n\n    // Calculate curvePoint c2 -> c3\n    const c2c3Distance = Math.sqrt(\n      // eslint-disable-next-line no-restricted-properties\n      Math.pow(c2.x - c3.x, 2) + Math.pow(c2.y - c3.y, 2),\n    );\n    const c2c3DistanceRatio = curveRadius / c2c3Distance;\n    const c2c3CurvePoint = [\n      ((1 - c2c3DistanceRatio) * c2.x + c2c3DistanceRatio * c3.x).toFixed(1),\n      ((1 - c2c3DistanceRatio) * c2.y + c2c3DistanceRatio * c3.y).toFixed(1),\n    ];\n\n    // If at last coord of polygon, also save that as starting point\n    if (i === pathCoords.length - 1) {\n      path.unshift(`M${c2c3CurvePoint.join(',')}`);\n    }\n\n    // Line to start of curve (L endcoord)\n    path.push(`L${c1c2CurvePoint.join(',')}`);\n    // Bezier line around curve (Q controlcoord endcoord)\n    path.push(`Q${c2.x},${c2.y},${c2c3CurvePoint.join(',')}`);\n  }\n  // Logically connect path to starting point again\n  // (shouldn't be necessary as path ends there anyway, but seems cleaner)\n  path.push('Z');\n\n  return path.join(' ');\n}\n","import React from 'react';\nimport { compose, withProps } from 'recompose';\nimport styled from 'styled-components';\nimport createRoundedPathString from '../utils/path-utils';\n\nimport {\n  getStrokeColor,\n  getStrokeWidth,\n  getFillColor,\n  getCornerRadius,\n} from '../utils/cutout-style.utils';\n\nconst Svg = styled.svg`\n  ${props => `\n    position: fixed;\n    top: ${props.svgOffset.top}px;\n    left: ${props.svgOffset.left}px;\n    width: 100vw;\n    height: 100vh;\n    stroke: ${getStrokeColor(props)};\n    stroke-width: ${getStrokeWidth(props)};\n    fill: ${getFillColor(props)};\n  `}\n`;\n\nconst Polygon = ({\n  svgOffset,\n  pathComponent,\n  strokeColor,\n  strokeWidth,\n  fillColor,\n}) => (\n  <Svg\n    svgOffset={svgOffset}\n    strokeColor={strokeColor}\n    fillColor={fillColor}\n    strokeWidth={strokeWidth}\n  >\n    {pathComponent}\n  </Svg>\n);\n\nexport default compose(\n  withProps(({ points, ...rest }) => {\n    const cornerRadius = parseInt(getCornerRadius(rest), 10);\n    const pathComponent = cornerRadius ? (\n      <path\n        d={createRoundedPathString(\n          points.map(([x, y]) => ({ x, y })),\n          cornerRadius,\n        )}\n      />\n    ) : (\n      <polyline\n        points={[...points, points[0]].map(([x, y]) => `${x},${y}`).join(' ')}\n      />\n    );\n\n    return {\n      pathComponent,\n    };\n  }),\n)(Polygon);\n","import styled from 'styled-components';\nimport React, { forwardRef } from 'react';\n\nimport {\n  generateSroke,\n  getStrokeColor,\n  getFillColor,\n  getCornerRadius,\n  getStrokeWidth,\n} from '../utils/cutout-style.utils';\nimport Polygon from './Polygon';\n\nconst transitionDuration = '0.0s';\n\n// calculates the boundingbox for visualization position in case of a polygon\nfunction calculateBoundingBox(points, polygonOffset) {\n  if (!points) return {};\n\n  const bbox = points.reduce(\n    (acc, [x, y]) => ({\n      x1: acc.x1 && acc.x1 < x ? acc.x1 : x,\n      y1: acc.y1 && acc.y1 < y ? acc.y1 : y,\n      x2: acc.x2 && acc.x2 > x ? acc.x2 : x,\n      y2: acc.y2 && acc.y2 > y ? acc.y2 : y,\n    }),\n    {},\n  );\n\n  return {\n    x: bbox.x1 - polygonOffset.left,\n    y: bbox.y1 - polygonOffset.top,\n    width: bbox.x2 - bbox.x1,\n    height: bbox.y2 - bbox.y1,\n  };\n}\n\n// used for RECT scanFeedback style\nexport const Rect = styled.div`\n  position: absolute;\n  transition: top ${transitionDuration}, left ${transitionDuration},\n    width ${transitionDuration}, height ${transitionDuration};\n\n  ${props => `\n    \n    border: ${getStrokeWidth(props)}px solid transparent;\n\n    width: ${props.initialStyle.width}px;\n    height: ${props.initialStyle.height}px;\n    top: ${props.initialStyle.top}px;\n    left: ${props.initialStyle.left}px;\n    border-radius: ${props.initialStyle.borderRadius}px;\n\n\n    ${props.show &&\n      `\n      border: ${generateSroke(props)};\n      background-color: ${getFillColor(props)};\n    `};\n    \n  `};\n`;\n\nconst Wrapper = styled.div`\n  ${props => `\n    position: absolute;\n    transition: top ${transitionDuration}, left ${transitionDuration}, width ${transitionDuration}, height ${transitionDuration};\n    background-clip: content-box;\n    border: ${generateSroke(props)};\n\n    ${props.feedbackStyle === 'rect' &&\n      `\n      border: ${getStrokeWidth(props)}px solid transparent;\n    `};\n  \n    ${props.feedbackStyle === 'contour_rect' &&\n      `\n      background-color: ${getFillColor(props)};\n      border-radius: ${props.cornerRadius}px;\n\n      ${props.points &&\n        `\n        border: ${getStrokeWidth(props)}px solid transparent;\n      `}\n    `};\n\n    ${props.feedbackStyle === 'contour_underline' &&\n      `\n      transform-origin: top;\n      border-top: none;\n      top: ${props.y + props.height}px !important;\n      height: 0px !important;\n      width: ${props.width}px !important;\n\n      ${props.points &&\n        `\n        left: ${props.x}px !important;\n      `}\n\n      background-color: ${getStrokeColor(props)};\n    `};\n\n    ${props.feedbackStyle === 'contour_point' &&\n      `\n      border-radius: 50%;\n      top: ${props.y + props.height}px !important; \n      left: ${props.x + props.width / 2}px !important;\n      height: 0px !important;\n      width: 0px !important;\n    `};\n  `};\n`;\n\nexport const ScanFeedbackElement = forwardRef(({ ...rest }, innerRef) => (\n  <Wrapper\n    ref={innerRef}\n    {...rest}\n    {...calculateBoundingBox(rest.points, rest.polygonOffset)}\n  >\n    {rest.points &&\n      (rest.feedbackStyle === 'contour_rect' ||\n        rest.feedbackStyle === 'rect') && <Polygon {...rest} />}\n  </Wrapper>\n));\n\nexport default {};\n","import React from 'react';\nimport {\n  compose,\n  withState,\n  withHandlers,\n  lifecycle,\n  defaultProps,\n  withProps,\n  onlyUpdateForKeys,\n} from 'recompose';\nimport styled from 'styled-components';\n\nimport { getAnimationElements } from '../utils/animations';\nimport { Rect } from './ScanFeedback';\n\nlet newElements;\n\nconst Wrapper = styled.div``;\n\nconst getRectStyle = feedbackElements => {\n  if (!feedbackElements.length) return {};\n\n  const { y: top, x: left, width, height } = feedbackElements[0];\n\n  return {\n    width,\n    height,\n    top,\n    left,\n  };\n};\n\nconst ScanFeedback = ({\n  config,\n  pose,\n  handlePoseComplete,\n  firstRun,\n  initialRectStyle,\n  cutoutId,\n  feedbackElements,\n  hide,\n  polygonOffset,\n  renderRect,\n}) => {\n  const [AnimationParent, AnimatedScanFeedbackElement] = getAnimationElements(\n    config,\n  );\n\n  return (\n    <Wrapper style={{ display: hide ? 'none' : 'block' }}>\n      {renderRect ? (\n        <Rect\n          show={feedbackElements.length}\n          style={getRectStyle(feedbackElements)}\n          initialStyle={initialRectStyle}\n        />\n      ) : (\n        <AnimationParent\n          firstRun={firstRun}\n          onPoseComplete={handlePoseComplete}\n          duration={config.animationDuration}\n          pose={pose}\n        >\n          {feedbackElements.map((e, i) => (\n            <AnimatedScanFeedbackElement\n              // done here due to rapid changes ( styled-components would generate a new class each time )\n              style={{\n                top: e.y,\n                left: e.x,\n                width: e.width,\n                height: e.height,\n                visibility: e.hidden ? 'hidden' : 'visible',\n              }}\n              key={`${cutoutId}_${i}`}\n              {...config}\n              {...e}\n              polygonOffset={polygonOffset}\n            />\n          ))}\n        </AnimationParent>\n      )}\n    </Wrapper>\n  );\n};\n\nexport default compose(\n  defaultProps({\n    config: {\n      feedbackStyle: '',\n      animation: '',\n      elements: [],\n    },\n  }),\n  withProps(({ config }) => ({\n    config: {\n      ...config,\n      elements: config.elements || [],\n      feedbackStyle: config.feedbackStyle && config.feedbackStyle.toLowerCase(),\n      animation: config.animation && config.animation.toLowerCase(),\n    },\n    renderRect:\n      config.feedbackStyle.toLowerCase() === 'rect' &&\n      config.elements.length &&\n      config.elements[0] &&\n      !config.elements[0].points,\n  })),\n  withState('feedbackElements', 'setFeedbackElements', []),\n  withState('nextFeedbackElements', 'setNextFeedbackElements', []),\n  withState('pose', 'setPose', null),\n  withState('firstRun', 'setFirstRun', true), // for not delaying PULSE on first run\n  withHandlers({\n    handlePoseComplete: ({\n      config,\n      setPose,\n      setFirstRun,\n      setFeedbackElements,\n    }) => pose => {\n      if (newElements) {\n        newElements = false;\n        setFeedbackElements(config.elements);\n      }\n      setPose(pose !== 'reverse' ? 'reverse' : 'active');\n      setFirstRun(false);\n    },\n  }),\n  lifecycle({\n    componentDidMount() {\n      const { config, setPose } = this.props;\n      if (config.animation || config.animation !== 'none') {\n        this.props.setFeedbackElements(config.elements);\n        setPose('active');\n      }\n    },\n    componentWillReceiveProps(nextProps) {\n      if (\n        this.props.config.lastFeedbackUpdate !==\n        nextProps.config.lastFeedbackUpdate\n      ) {\n        // TODO: is this still needed ?!?!\n        // if (\n        //   nextProps.config.elements.length < 3 ||\n        //   !nextProps.config.animation ||\n        //   nextProps.config.animation === 'none' ||\n        //   ['rect', 'contour_rect'].includes(nextProps.config.feedbackStyle)\n        // ) {\n        //   this.props.setPose(null);\n        //   this.props.setFeedbackElements(nextProps.config.elements);\n        //   return;\n        // }\n\n        if (!nextProps.pose) {\n          this.props.setPose('active');\n        }\n\n        if (\n          nextProps.renderRect ||\n          !nextProps.config.animation ||\n          nextProps.config.animation === 'none' ||\n          ['rect', 'contour_rect'].includes(nextProps.config.feedbackStyle) ||\n          nextProps.config.elements.length >= this.props.config.elements.length\n        ) {\n          this.props.setFeedbackElements(nextProps.config.elements);\n        } else {\n          newElements = true;\n\n          // take the new points and add the remaining old ones but hidden, so we won't fuck up the running animations when reducing the element size\n          const hiddenElements = this.props.config.elements\n            .slice(\n              nextProps.config.elements.length -\n                this.props.config.elements.length,\n            )\n            .map(e => ({ ...e, hidden: true }));\n\n          this.props.setFeedbackElements([\n            ...nextProps.config.elements,\n            ...hiddenElements,\n          ]);\n        }\n      }\n    },\n  }),\n)(ScanFeedback);\n","import React from 'react';\nimport posed from 'react-pose';\n\nimport { ScanFeedbackElement } from '../Components/ScanFeedback';\nimport { getStrokeWidth } from './cutout-style.utils';\n\nconst quickPopupTransition = {\n  transition: ({ duration = 1000, elements }) => ({\n    duration: duration / elements.length,\n    type: 'keyframes',\n    values: [0, 1, 1, 0],\n    times: [0, 0.01, 0.99, 1],\n  }),\n  opacity: 1,\n};\n\nconst fadeInTransition = {\n  transition: ({ duration = 1000, elements }) => ({\n    duration: duration / elements.length,\n    type: 'keyframes',\n    values: [0, 1, 0],\n    times: [0, 0.5, 1],\n  }),\n  opacity: 1,\n};\n\nconst blinkFadeInTransition = {\n  transition: ({ duration = 1000, elements }) => ({\n    duration: 300,\n    type: 'keyframes',\n    values: [0, 1, 0],\n    times: [0, 0.5, 1],\n  }),\n  opacity: 1,\n};\n\nconst pulseFadeInTransition = {\n  transition: ({ duration = 1000, elements }) => ({\n    duration: 300,\n    type: 'keyframes',\n    values: [0, 1, 0, 0],\n    times: [0, 0.25, 0.3, 1],\n  }),\n  opacity: 1,\n};\n\nconst resizeHeightTransition = {\n  transition: ({ duration = 1000, elements, strokeWidth }) => ({\n    duration: duration / elements.length,\n    type: 'keyframes',\n    values: [\n      1,\n      (getStrokeWidth({ strokeWidth }) + 3) / getStrokeWidth({ strokeWidth }),\n      1,\n    ],\n    times: [0, 0.5, 1],\n  }),\n  scaleY: 1,\n};\n\nconst resizeBorderTransition = {\n  transition: ({ duration = 1000, elements, strokeWidth }) => ({\n    duration: duration / elements.length,\n    type: 'keyframes',\n    values: [\n      1,\n      (getStrokeWidth({ strokeWidth }) + 3) / getStrokeWidth({ strokeWidth }),\n      1,\n    ],\n    times: [0, 0.5, 1],\n  }),\n  scale: 1,\n};\n\nconst animations = {\n  TRAVERSE_MULTI: {\n    parent: {\n      active: {\n        staggerChildren: ({ children, duration = 1000 }) =>\n          duration / (children.length * 2),\n      },\n      reverse: {},\n      inactive: {},\n    },\n    child: {\n      active: {\n        ...fadeInTransition,\n      },\n      reverse: { opacity: 0 },\n      inactive: { opacity: 0 },\n    },\n  },\n\n  TRAVERSE_SINGLE: {\n    parent: {\n      active: {\n        staggerChildren: 100,\n      },\n      reverse: {},\n      inactive: {},\n    },\n    child: {\n      active: {\n        ...quickPopupTransition,\n      },\n      reverse: { opacity: 0 },\n      inactive: { opacity: 0 },\n    },\n  },\n\n  KITT: {\n    parent: {\n      active: {\n        staggerChildren: 50,\n      },\n      reverse: {\n        staggerChildren: 50,\n        staggerDirection: -1,\n      },\n      inactive: {},\n    },\n    child: {\n      active: {\n        ...quickPopupTransition,\n      },\n      reverse: {\n        ...quickPopupTransition,\n      },\n      inactive: { opacity: 0 },\n    },\n  },\n\n  BLINK: {\n    parent: {\n      active: {},\n      reverse: {},\n      inactive: {},\n    },\n    child: {\n      active: {\n        ...blinkFadeInTransition,\n      },\n      reverse: {\n        ...blinkFadeInTransition,\n      },\n      inactive: { opacity: 0 },\n    },\n  },\n\n  RESIZE: {\n    underline: {\n      parent: {\n        active: {\n          staggerChildren: ({ children, duration = 1000 }) =>\n            duration / (children.length * 2),\n        },\n        reverse: {},\n        inactive: {},\n      },\n      child: {\n        active: {\n          ...resizeHeightTransition,\n        },\n        reverse: { opacity: 1 },\n        inactive: { opacity: 1 },\n      },\n    },\n    point: {\n      parent: {\n        active: {\n          staggerChildren: ({ children, duration = 1000 }) =>\n            duration / (children.length * 2),\n        },\n        reverse: {},\n        inactive: {},\n      },\n      child: {\n        active: {\n          ...resizeBorderTransition,\n        },\n        reverse: { opacity: 1 },\n        inactive: { opacity: 1 },\n      },\n    },\n  },\n\n  PULSE: {\n    parent: {\n      active: {\n        delayChildren: ({ firstRun }) => (firstRun ? 0 : 600),\n      },\n      reverse: {\n        delayChildren: 600,\n      },\n      inactive: {},\n    },\n    child: {\n      active: {\n        ...pulseFadeInTransition,\n      },\n      reverse: {\n        ...pulseFadeInTransition,\n      },\n      inactive: { opacity: 0 },\n    },\n  },\n};\n\n// it is nessecary to already create the React components (no dynamic solution worked)\nconst ResizePointChild = posed(ScanFeedbackElement)({\n  ...animations.RESIZE.point.child,\n});\n\nconst ResizePointParent = posed.div({\n  ...animations.RESIZE.point.parent,\n});\n\nconst ResizeUnderlineChild = posed(ScanFeedbackElement)({\n  ...animations.RESIZE.underline.child,\n});\n\nconst ResizeUnderlineParent = posed.div({\n  ...animations.RESIZE.underline.parent,\n});\n\nconst TraverseMultiChild = posed(ScanFeedbackElement)({\n  ...animations.TRAVERSE_MULTI.child,\n});\n\nconst TraverseMultiParent = posed.div({\n  ...animations.TRAVERSE_MULTI.parent,\n});\n\nconst TraverseSingleChild = posed(ScanFeedbackElement)({\n  ...animations.TRAVERSE_SINGLE.child,\n});\n\nconst TraverseSingleParent = posed.div({\n  ...animations.TRAVERSE_SINGLE.parent,\n});\n\nconst PulseChild = posed(ScanFeedbackElement)({\n  ...animations.PULSE.child,\n});\n\nconst PulseParent = posed.div({\n  ...animations.PULSE.parent,\n});\n\nconst BlinkChild = posed(ScanFeedbackElement)({\n  ...animations.BLINK.child,\n});\n\nconst BlinkParent = posed.div({\n  ...animations.BLINK.parent,\n});\n\nconst KittChild = posed(ScanFeedbackElement)({\n  ...animations.KITT.child,\n});\n\nconst KittParent = posed.div({\n  ...animations.KITT.parent,\n});\n\nconst NoneParent = ({ children }) => <div>{children}</div>;\n\nconst components = {\n  none: [NoneParent, ScanFeedbackElement],\n  kitt: [KittParent, KittChild],\n  blink: [BlinkParent, BlinkChild],\n  pulse: [PulseParent, PulseChild],\n  traverse_multi: [TraverseMultiParent, TraverseMultiChild],\n  traverse_single: [TraverseSingleParent, TraverseSingleChild],\n  resize_point: [ResizePointParent, ResizePointChild],\n  resize_underline: [ResizeUnderlineParent, ResizeUnderlineChild],\n  resize: [], // ohoh hacky // matze(13.02.19) but why !?!?\n};\n\nexport const getAnimationElements = ({\n  feedbackStyle = 'rect',\n  animation = 'none',\n} = {}) => {\n  if (!components[animation]) {\n    console.warn(`animation ${animation} not found!`);\n    return components.none;\n  }\n\n  if (['rect', 'contour_rect'].includes(feedbackStyle)) return components.none;\n\n  if (feedbackStyle === 'contour_point' && animation === 'resize') {\n    return components.resize_point;\n  }\n\n  if (feedbackStyle === 'contour_underline' && animation === 'resize') {\n    return components.resize_underline;\n  }\n\n  return components[animation];\n};\n\nexport default {};\n","import React from 'react';\nimport {\n  compose,\n  defaultProps,\n  withState,\n  lifecycle,\n  withHandlers,\n  withProps,\n} from 'recompose';\nimport styled from 'styled-components';\nimport CSSTransition from 'react-transition-group/CSSTransition';\nimport ScanFeedbackManager from './ScanFeedbackManager';\nimport { HexARGB2rgba } from '../utils/color-utils';\nimport createTimeoutService from '../services/timeout';\n\n// DEFAULTS\nconst STROKE_WIDTH = 2;\nconst STROKE_COLOR = 'FFFFFF';\nconst CORNER_RADIUS = 8;\n\nconst TIMEOUT = 700;\n\nconst timeout = createTimeoutService();\n\nconst Wrapper = styled.div`\n  position: fixed;\n  border-style: solid;\n\n  ${props => `\n        width: ${props.rect.right - props.rect.left}px;\n        height: ${props.rect.bottom - props.rect.top}px;\n        top: ${props.rect.top - props.strokeWidth}px;\n        left: ${props.rect.left - props.strokeWidth}px;\n        border-radius: ${props.cornerRadius}px;\n        border-width: ${props.strokeWidth}px;\n        border-color: ${\n          props.scanning\n            ? HexARGB2rgba(props.feedbackStrokeColor || props.strokeColor)\n            : HexARGB2rgba(props.strokeColor)\n        };\n    `}\n`;\n\nconst calculateInitialRectStyle = (rect, strokeWidth, borderRadius) => ({\n  width: rect.right - rect.left,\n  height: rect.bottom - rect.top,\n  top: -strokeWidth,\n  left: -strokeWidth,\n  borderRadius,\n});\n\nconst getAnimationTimeout = (animation = '') => {\n  const timeouts = {\n    fade: 500,\n    zoom: 500,\n  };\n\n  return timeouts[animation.toLowerCase()] || 0;\n};\n\nconst Cutout = ({ show, renderFeedback, scanFeedback, ...rest }) => (\n  <CSSTransition timeout={getAnimationTimeout(rest.classNames)} {...rest}>\n    <Wrapper {...rest}>\n      {renderFeedback && (\n        <ScanFeedbackManager\n          initialRectStyle={calculateInitialRectStyle(\n            rest.rect,\n            rest.strokeWidth,\n            rest.cornerRadius,\n          )}\n          hide={!rest.scanning}\n          cutoutId={rest.id}\n          polygonOffset={{\n            top: rest.rect.top,\n            left: rest.rect.left,\n          }}\n          config={scanFeedback}\n        />\n      )}\n    </Wrapper>\n  </CSSTransition>\n);\n\nexport default compose(\n  withState('show', 'setShow'),\n  withState('scanning', 'setScanning'),\n  defaultProps({\n    rect: {\n      left: 0, // x\n      top: 0, // y\n      right: 100,\n      bottom: 100,\n    },\n    strokeWidth: STROKE_WIDTH,\n    strokeColor: STROKE_COLOR,\n    cornerRadius: CORNER_RADIUS,\n  }),\n  withProps(({ scanFeedback }) => ({\n    renderFeedback: scanFeedback.elements && !!scanFeedback.elements.length,\n  })),\n  withHandlers({\n    resetScanTimeout: ({ setScanning }) => () => {\n      setScanning(true);\n      timeout(TIMEOUT, () => setScanning(false));\n    },\n  }),\n  lifecycle({\n    componentDidMount() {\n      this.props.setShow(true);\n    },\n    componentWillReceiveProps(next) {\n      if (\n        next.scanFeedback.lastFeedbackUpdate !==\n        this.props.scanFeedback.lastFeedbackUpdate\n      ) {\n        this.props.resetScanTimeout();\n      }\n    },\n  }),\n)(Cutout);\n","export default function createTimeoutService() {\n  let ctx;\n\n  return (ms, cb) => {\n    clearTimeout(ctx);\n    ctx = setTimeout(cb, ms);\n  };\n}\n","import { hexToRGBa } from '../../utils/color-utils';\n\nconst limitCordnerRadius = (w, h, r) => {\n  const halfMin = Math.min(w, h) / 2;\n  return halfMin < r ? halfMin : r;\n};\n\nexport default function createMaskService({\n  canvasEl,\n  outerColor = '000000',\n  outerAlpha = 0.0,\n  rerenderOnAdd = true,\n  rerenderOnRemove = true,\n}) {\n  const currentCutoutState = {};\n\n  let outerRGBa = hexToRGBa(outerColor, outerAlpha);\n  const ctx = canvasEl.getContext('2d');\n\n  // arc tutorial: https://www.html5canvastutorials.com/tutorials/html5-canvas-arcs/\n  function drawRect({ rect, cornerRadius = 0, strokeWidth = 0 }) {\n    if (cornerRadius < strokeWidth) cornerRadius = strokeWidth;\n\n    const { top, left, right, bottom } = rect;\n\n    const w = right - left;\n    const h = bottom - top;\n    const x = left;\n    const y = top;\n\n    cornerRadius = limitCordnerRadius(w, h, cornerRadius);\n\n    ctx.beginPath();\n\n    ctx.moveTo(x + cornerRadius, y - strokeWidth);\n    ctx.lineTo(x + w - cornerRadius + strokeWidth, y - strokeWidth);\n    ctx.arc(\n      x + w - cornerRadius + strokeWidth,\n      y + cornerRadius - strokeWidth,\n      cornerRadius,\n      1.5 * Math.PI,\n      0,\n    );\n    ctx.lineTo(x + w + strokeWidth, y + h - cornerRadius + strokeWidth);\n    ctx.arc(\n      x + w - cornerRadius + strokeWidth,\n      y + h - cornerRadius + strokeWidth,\n      cornerRadius,\n      0,\n      0.5 * Math.PI,\n    );\n    ctx.lineTo(x + cornerRadius - strokeWidth, y + h + strokeWidth);\n    ctx.arc(\n      x + cornerRadius - strokeWidth,\n      y + h - cornerRadius + strokeWidth,\n      cornerRadius,\n      0.5 * Math.PI,\n      Math.PI,\n    );\n    ctx.lineTo(x - strokeWidth, y + cornerRadius - strokeWidth);\n    ctx.arc(\n      x + cornerRadius - strokeWidth,\n      y + cornerRadius - strokeWidth,\n      cornerRadius,\n      Math.PI,\n      1.5 * Math.PI,\n    );\n\n    ctx.closePath();\n\n    ctx.fillStyle = 'black'; // fill with random color (it is cut out anyway)\n    ctx.fill();\n  }\n\n  // fills the whole canvas with a passed fillStyle\n  function fillWhole(fillStyle) {\n    ctx.fillStyle = fillStyle;\n    ctx.fillRect(0, 0, canvasEl.width, canvasEl.height);\n  }\n\n  function render() {\n    ctx.clearRect(0, 0, canvasEl.width, canvasEl.height);\n\n    ctx.globalCompositeOperation = 'source-over';\n    fillWhole(outerRGBa);\n\n    ctx.globalCompositeOperation = 'destination-out';\n    Object.values(currentCutoutState).forEach(drawRect);\n  }\n\n  function addCutout(cutout) {\n    currentCutoutState[cutout.id] = cutout;\n    if (rerenderOnAdd) render();\n  }\n\n  function modifyCutout(cutout) {\n    // TODO animate changes\n    currentCutoutState[cutout.id] = cutout;\n    render();\n  }\n\n  function removeCutout(cutoutId) {\n    // TODO animate remove\n    delete currentCutoutState[cutoutId];\n    if (rerenderOnRemove) render();\n  }\n\n  function update() {\n    return requestAnimationFrame(update);\n  }\n\n  function setConfig(newOuterColor, newOuterAlpha) {\n    outerRGBa = hexToRGBa(newOuterColor, newOuterAlpha);\n    render();\n  }\n\n  // init\n  fillWhole(outerRGBa);\n  update();\n\n  // expose api\n  const maskService = {\n    addCutout,\n    modifyCutout,\n    removeCutout,\n    render,\n    setConfig,\n  };\n\n  return maskService;\n}\n","const sleep = ms => new Promise(r => setTimeout(r, ms));\n\nfunction createFeedbacks(initial = []) {\n  let feedbacks = [...initial];\n\n  return {\n    getFeedbacks: () => feedbacks,\n    set: newFeedbacks => {\n      feedbacks = [...newFeedbacks];\n      return feedbacks;\n    },\n    add: feedback => {\n      feedbacks = [...feedbacks, feedback];\n      return feedbacks;\n    },\n  };\n}\n\nasync function runFeedbackBenchmark({\n  setupCutoutsConfig = {},\n  feedbackCount = 8,\n} = {}) {\n  window.publish('setupMask', {\n    outerColor: '000000',\n    outerAlpha: 0.3,\n  });\n\n  window.publish('setupCutouts', [\n    {\n      scanFeedback: {\n        animation: 'RESIZE',\n        redrawTimeout: 0,\n        fillColor: '220099FF',\n        strokeWidth: 2,\n        strokeColor: 'FF0099FF',\n        cornerRadius: 4,\n        feedbackStyle: 'contour_point',\n        animationDuration: 1000,\n      },\n      feedbackStrokeColor: 'FF0099FF',\n      id: '1',\n      visible: 1,\n      animation: 'none',\n      rect: { bottom: 210, top: 110, left: 150, right: 250 },\n      strokeWidth: 2,\n      cornerRadius: 20,\n      strokeColor: 'FFFFFFFF',\n      ...setupCutoutsConfig,\n    },\n  ]);\n\n  const merge = (a, b) => ({ ...a, ...b });\n  const getLast = arr => arr.slice(-1)[0];\n  const random = (min = 0, max = 100) => Math.floor(Math.random() * max) + min;\n\n  const initialfeedbacks1 = Array(...Array(feedbackCount)).map((e, i) => ({\n    y: 250,\n    x: random(1, 1200),\n    width: 14.351851267873542,\n    height: 20.833332485622833,\n  }));\n\n  // these feedbacks are slightly below the initialfeedbacks\n  const initialfeedbacks2 = initialfeedbacks1.map(e => ({ ...e, y: 252 }));\n\n   // these feedbacks are less\n  const initialfeedbacks3 = initialfeedbacks2.slice(-2);\n\n  //these feedbacks are randomly spreaded\n  const initialfeedbacks4 = Array(...Array(feedbackCount - 4)).map((e, i) => ({\n    y: 200,\n    x: random(1, 1200),\n    width: 14.351851267873542,\n    height: 20.833332485622833,\n  }));\n\n  const feedbackService = createFeedbacks(initialfeedbacks1);\n\n  let i;\n  for (i = 0; i <= 100; i += 1) {\n    console.time('loop');\n    // const y = 400 - i * 2;\n    // const feedbacks = feedbackService.getFeedbacks();\n    const updatedFeedbacks = feedbackService.set(\n      // feedbacks.map(f => merge(f, { y })),\n      i % 2 ? initialfeedbacks3 : initialfeedbacks1,\n    );\n\n    // updatedFeedbacks = feedbackService.add(\n    //   merge(getLast(updatedFeedbacks), {\n    //     y,\n    //     x: random(1, 1200),\n    //   }),\n    // );\n\n    window.publish('updateFeedback', {\n      1: updatedFeedbacks,\n    });\n\n    console.timeEnd('loop');\n    await sleep(30);\n  }\n}\n\nwindow.runFeedbackBenchmark = runFeedbackBenchmark;\n","import { toClass } from 'recompose';\nimport { mount } from 'enzyme/build';\nimport React from 'react';\n\nimport './benchmark';\n\nexport const mountRecomposeComponent = (Component, enhance) => {\n  const ComponentClass = toClass(Component);\n  const Enhanced = enhance(ComponentClass);\n  const wrapper = mount(<Enhanced />);\n\n  return {\n    wrapper,\n    getProps: () => wrapper.find(ComponentClass).props(),\n  };\n};\n\nexport const canvasMock = {\n  getContext: () => ({\n    beginPath: () => {},\n    moveTo: () => {},\n    lineTo: () => {},\n    arc: () => {},\n    closePath: () => {},\n    fill: () => {},\n    fillRect: () => {},\n    clearRect: () => {},\n  }),\n};\n","import React from 'react';\nimport { compose, withHandlers, lifecycle, defaultProps } from 'recompose';\nimport styled from 'styled-components';\n\nimport { withRefs } from 'react-hoc-utils';\nimport createMaskService from '../services/mask/mask-service';\nimport { canvasMock } from '../utils/test-utils';\n\nlet maskService;\n\nconst isTestEnv = process.env.NODE_ENV === 'test';\n\n// compares cutouts according to id and returns not included ones in the second cutouts object\nconst getMissingIds = (nextCutouts, cutouts) =>\n  Object.keys(cutouts).filter(x => !Object.keys(nextCutouts).includes(x));\n\nconst Canvas = styled.canvas`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n`;\n\nconst setCanvasRef = refs => r =>\n  refs.set('canvas', isTestEnv ? canvasMock : r);\n\nconst Mask = ({ refs }) => <Canvas ref={setCanvasRef(refs)} />;\n\nexport default compose(\n  withRefs,\n  defaultProps({\n    outerColor: 'FFFFFF',\n    outerAlpha: 0.0,\n    onInit: () => {},\n  }),\n  withHandlers({\n    initializeMaskService: ({\n      outerColor,\n      outerAlpha,\n      refs: { canvas },\n    }) => () => {\n      canvas.width = canvas.offsetWidth;\n      canvas.height = canvas.offsetHeight;\n\n      maskService = createMaskService({\n        canvasEl: canvas,\n        outerColor,\n        outerAlpha,\n        // we don't rerender on add, so we can trigger render manually after cssTransition is finished\n        rerenderOnAdd: false,\n      });\n    },\n    updateCanvasDimensions: ({ refs: { canvas } }) => () => {\n      canvas.width = canvas.offsetWidth;\n      canvas.height = canvas.offsetHeight;\n\n      if (maskService) maskService.render();\n    },\n  }),\n  lifecycle({\n    componentDidMount() {\n      this.props.initializeMaskService();\n      window.addEventListener('resize', this.props.updateCanvasDimensions);\n      this.props.onInit(maskService);\n    },\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.props.updateCanvasDimensions);\n    },\n    componentWillReceiveProps(next) {\n      // update mask config on the fly\n      if (\n        next.outerColor !== this.props.outerColor ||\n        next.outerAlpha !== this.props.outerAlpha\n      ) {\n        if (maskService)\n          maskService.setConfig(next.outerColor, next.outerAlpha);\n      }\n\n      // add new cutouts\n      if (getMissingIds(this.props.cutouts, next.cutouts).length) {\n        if (!maskService) next.initializeMaskService();\n\n        Object.values(next.cutouts)\n          .filter(cutout => !this.props.cutouts[cutout.id]) // filter only new\n          .forEach(maskService.addCutout);\n\n        return;\n      }\n\n      // remove old cutouts\n      if (getMissingIds(next.cutouts, this.props.cutouts).length) {\n        if (!maskService) next.initializeMaskService();\n\n        Object.values(this.props.cutouts)\n          .filter(cutout => !next.cutouts[cutout.id]) // filter only old\n          .map(cutout => cutout.id) // only ids\n          .forEach(maskService.removeCutout);\n\n        return;\n      }\n\n      // modify changed cutouts\n      Object.values(next.cutouts)\n        .filter(\n          cutout =>\n            this.props.cutouts[cutout.id] &&\n            cutout.lastUpdate !== this.props.cutouts[cutout.id].lastUpdate,\n        )\n        .forEach(maskService.modifyCutout);\n    },\n  }),\n)(Mask);\n","/* eslint-disable no-undef */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport throttle from 'lodash/throttle';\nimport {\n  compose,\n  lifecycle,\n  withHandlers,\n  withState,\n  setPropTypes,\n  withProps,\n} from 'recompose';\nimport styled from 'styled-components';\n\nimport TransitionGroup from 'react-transition-group/TransitionGroup';\nimport pubsub from '../services/pubSub/pubSub';\nimport { omit, byKey } from '../utils/obj-utils';\nimport Cutout from './Cutout';\nimport Mask from './Mask';\n\nimport './cutout.css';\n\nconst updateFeedbackLimit = 40; // rate limit updating 1000/30 = 33FPS\n\nlet setupCutoutsObservable;\nlet removeCutoutsObservable;\nlet updateFeedbackObservable;\nlet setupMaskObservable;\n\nlet maskService;\n\nconst Wrapper = styled.div`\n  width: 100%;\n  height: 100%;\n`;\n\nconst propTypes = {\n  cutouts: PropTypes.object.isRequired,\n};\n\nconst isVisible = ({ visible }) => visible;\n\n// recalculate the position of the feedback elements to relative until it is send relative from sdk\nconst absoluteToRelative = (cutout, elements) =>\n  elements.map(e => ({\n    ...e,\n    svgOffset: {\n      top: !cutout.useSvgOffset ? 0 : -cutout.rect.top,\n      left: !cutout.useSvgOffset ? 0 : -cutout.rect.left,\n    },\n    x:\n      e.x === undefined\n        ? undefined\n        : e.x - cutout.rect.left - (cutout.scanFeedback.strokeWidth || 2), // TODO: grab 2 from config\n    y:\n      e.y === undefined\n        ? undefined\n        : e.y - cutout.rect.top - (cutout.scanFeedback.strokeWidth || 2),\n  }));\n\nexport const CutoutManager = ({\n  cutouts,\n  maskConfig,\n  handleMaskInit,\n  handleAnimatonEnterEnd,\n  handleAnimatonExitEnd,\n  handleAnimatonEnterStart,\n}) => (\n  <Wrapper>\n    <Mask {...maskConfig} cutouts={cutouts} onInit={handleMaskInit} />\n    <TransitionGroup>\n      {Object.values(cutouts).map(cutout => (\n        <Cutout\n          onEntered={handleAnimatonEnterEnd}\n          onEnter={handleAnimatonEnterStart}\n          onExited={handleAnimatonExitEnd}\n          classNames={cutout.animation ? cutout.animation.toLowerCase() : ''}\n          key={`Cutout_${cutout.id}`}\n          {...cutout}\n        />\n      ))}\n    </TransitionGroup>\n  </Wrapper>\n);\n\n// externalHoc is used to inject mock properties for testing\nexport const enhance = (externalHoc = x => x) =>\n  compose(\n    withState('maskConfig', 'setMaskConfig'),\n    withState('cutouts', 'setCutouts', {}),\n    withHandlers({\n      handleAnimatonEnterStart: ({ cutouts }) => ({ id }) => {\n        const cutout = cutouts[id];\n\n        if (!cutout.animation || cutout.animation.toLowerCase() === 'none') {\n          maskService.render();\n        }\n        // TODO: callback to native\n      },\n      handleAnimatonEnterEnd: () => ({ id }) => {\n        maskService.render();\n        // TODO: callback to native\n      },\n      handleAnimatonExitEnd: () => ({ id }) => {\n        // TODO: callback to native\n      },\n      handleMaskInit: () => service => {\n        maskService = service;\n      },\n      setupCutouts: ({ setCutouts, cutouts }) => newCutouts => {\n        const enhancedCutouts = newCutouts.map(c => ({\n          ...(cutouts[c.id] || {}),\n          ...c,\n          scanFeedback: {\n            ...(cutouts[c.id] ? cutouts[c.id].scanFeedback || {} : {}),\n            ...(c.scanFeedback || {}),\n            // reset visual feedback when updating cutouts\n            elements: [],\n          },\n          lastUpdate: Date.now(),\n          visible: !!c.visible,\n        }));\n        const cutoutsObj = byKey(enhancedCutouts, 'id');\n        setCutouts(old => ({ ...old, ...cutoutsObj }));\n      },\n      updateFeedback: ({ setCutouts, cutouts }) => newFeedbackData => {\n        const updatedCutouts = Object.entries(newFeedbackData)\n          .filter(([id]) => cutouts[id])\n          .map(([id, elements]) => ({\n            ...cutouts[id],\n            scanFeedback: {\n              ...cutouts[id].scanFeedback,\n              lastFeedbackUpdate: Date.now(),\n              elements: absoluteToRelative(cutouts[id], elements),\n            },\n          }));\n\n        const cutoutsObj = byKey(updatedCutouts, 'id');\n        setCutouts(old => ({ ...old, ...cutoutsObj }));\n      },\n      removeCutouts: ({ setCutouts, cutouts }) => cutoutIds => {\n        const newCutouts = omit(cutouts, cutoutIds);\n        setCutouts(newCutouts);\n      },\n    }),\n    externalHoc,\n    withProps(({ cutouts }) => {\n      const visibleCutouts = Object.values(cutouts).filter(isVisible);\n\n      return {\n        cutouts: byKey(visibleCutouts, 'id'),\n      };\n    }),\n    lifecycle({\n      componentDidMount() {\n        setupCutoutsObservable = pubsub.subscribe(\n          'setupCutouts',\n          this.props.setupCutouts,\n        );\n        updateFeedbackObservable = pubsub.subscribe(\n          'updateFeedback',\n          throttle(this.props.updateFeedback, updateFeedbackLimit),\n        );\n        removeCutoutsObservable = pubsub.subscribe(\n          'removeCutouts',\n          this.props.removeCutouts,\n        );\n        setupMaskObservable = pubsub.subscribe(\n          'setupMask',\n          this.props.setMaskConfig,\n        );\n      },\n      componentWillUnmount() {\n        setupCutoutsObservable.unsubscribe();\n        removeCutoutsObservable.unsubscribe();\n        updateFeedbackObservable.unsubscribe();\n        setupMaskObservable.unsubscribe();\n      },\n    }),\n    setPropTypes(propTypes),\n  );\n\nexport default enhance()(CutoutManager);\n","import React from 'react';\nimport styled from 'styled-components';\nimport Cutouts from './Components/CutoutManager';\n\nconst Wrapper = styled.div`\n    width: 100vw;\n    height: 100vh;\n`;\n\nconst App = () => (\n  <Wrapper>\n    <Cutouts />\n  </Wrapper>\n);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.css';\n\nfunction addMetaTag(config) {\n  const meta = Object.assign(document.createElement('meta'), config);\n  document.getElementsByTagName('head')[0].appendChild(meta);\n}\n\nfunction getActualWidth() {\n  return parseInt(document.body.clientWidth * window.devicePixelRatio, 10);\n}\n\n\n// set calulated viewport, to have actual pixel perfect resolution on all devices\n// addMetaTag({\n//   name: 'viewport',\n//   content: `width=${getActualWidth()}, user-scalable=no`,\n// });\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}